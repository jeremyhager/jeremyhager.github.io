<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<link rel="search" type="application/opensearchdescription+xml" title="Yugawa" href="/opensearch.xml"><title data-react-helmet="true">Moving on with Foreman | Yugawa</title><meta data-react-helmet="true" property="og:title" content="Moving on with Foreman | Yugawa"><meta data-react-helmet="true" name="description" content="Troubleshooting Katello backups and virsh"><meta data-react-helmet="true" property="og:description" content="Troubleshooting Katello backups and virsh"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/styles.fc0728ef.css">
<link rel="preload" href="/styles.b2b95ca1.js" as="script">
<link rel="preload" href="/runtime~main.699e07b9.js" as="script">
<link rel="preload" href="/main.a77cb48e.js" as="script">
<link rel="preload" href="/1.2ea10890.js" as="script">
<link rel="preload" href="/2.a350c419.js" as="script">
<link rel="preload" href="/3.1212bc9f.js" as="script">
<link rel="preload" href="/ccc49370.ae4f279a.js" as="script">
<link rel="preload" href="/a6df03d7.60b6c868.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">Yugawa</strong></a><a class="navbar__item navbar__link" href="/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/aboutMe">About Me</a><a href="https://github.com/jeremyhager/yugawa-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">Yugawa</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/aboutMe">About Me</a></li><li class="menu__list-item"><a href="https://github.com/jeremyhager/yugawa-website" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--8 col--offset-2"><article><header><h1 class="margin-bottom--sm blogPostTitle_1mse">Moving on with Foreman</h1><div class="margin-vert--md"><time datetime="2020-09-01T00:00:00.000Z" class="blogPostDate_3bQP">September 1, 2020  Â· 5 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/jeremyhager/" target="_blank" rel="noreferrer noopener"><img src="https://avatars2.githubusercontent.com/u/47301461?s=460&amp;u=05e044dcce4be18b670f9e2c9bda99c511cd4009&amp;v=4" alt="Jeremy Hager"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/jeremyhager/" target="_blank" rel="noreferrer noopener">Jeremy Hager</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><img src="/img/light-half-full.jpg" width="256"><p>Foreman has been giving me a little trouble as I began to set it up. First thing that happened is I could not import errata correctly, and I tried 2 different scripts out there to accomplish it. After several re-tries, I figured a fresh start would be good and reverted the Foreman VM back to before all of these changes happened.</p><p>Well after going through the process again, I unfortunately ran into another issue: I tried to back up the server. I went through the entire process of importing GPG keys, syncing repos, publishing, etc. Following the guide I found <a href="https://www.lisenet.com/2018/katello-create-products-repositories-content-views-lifecycle-environments-activation-keys/" target="_blank" rel="noopener noreferrer">here</a>, step 12 is to use <code>katello-backup</code>. However the new version of this is <code>foreman-maintain</code>.</p><p>Eventually I found the right command: <code>sudo foreman-maintain backup offline /mnt/backup</code>. Everything seemed to go okay...</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Starting backup: </span><span class="token number" style="color:rgb(247, 140, 108)">2020</span><span class="token plain">-08-25 </span><span class="token number" style="color:rgb(247, 140, 108)">18</span><span class="token plain">:13:10 -0400</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Running preparation steps required to run the next scenarios</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Make sure Foreman DB is up:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/ Checking connection to the Foreman DB                               </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Running Backup</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Confirm turning off services is allowed:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">WARNING: This script will stop your services.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Do you want to proceed?, </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">yes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">, q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">quit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                                                      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Prepare backup Directory:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Creating backup folder /mnt/backup/katello-backup-2020-08-25-18-13-10 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Check </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> the directory exists and is writable:                        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#etc.</span></div></div></div></div></div><p>But then this hit me:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Backup Candlepin DB offline:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/ Collecting data from /var/opt/rh/rh-postgresql12/lib/pgsql/data/    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">FAIL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Failed executing </span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> --selinux --create --file</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/mnt/backup/katello-backup-2020-08-25-18-13-10/pgsql_data.tar --listed-incremental</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/mnt/backup/katello-backup-2020-08-25-18-13-10/.postgres.snar --transform </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;s,^,var/opt/rh/rh-postgresql12/lib/pgsql/data/,S&#x27;</span><span class="token plain"> -S *, </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exit</span><span class="token plain"> status </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain">:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> tar: /mnt/backup/katello-backup-2020-08-25-18-13-10/pgsql_data.tar: Wrote only </span><span class="token number" style="color:rgb(247, 140, 108)">4096</span><span class="token plain"> of </span><span class="token number" style="color:rgb(247, 140, 108)">10240</span><span class="token plain"> bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tar: Error is not recoverable: exiting now</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Scenario </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">Backup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> failed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">The following steps ended up </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> failing state:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">backup-offline-candlepin-db</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Resolve the failed steps and rerun</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">the command. In </span><span class="token keyword" style="font-style:italic">case</span><span class="token plain"> the failures are </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"> positives,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use --whitelist</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;backup-offline-candlepin-db&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">The runner is already </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> quit state</span></div></div></div></div></div><p>I spent a few days on this issue and tried multiple different avenues. To cut a long story short (re-initiating the backup, rebooting the server, starting PostgreSQL &quot;manually&quot;, reading <code>journalctl -xe</code>), I decided I needed to cut my losses and revert the VM again. So I took a snapshot of the vm, backed it up, and copied the xml of the broken server. Right now I don&#x27;t think I have the know-how to fix this, but it could be a good troubleshooting project later on. So onward and upward, after reverting the VM I re-did my work.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="importing-errata"></a>Importing errata<a aria-hidden="true" tabindex="-1" class="hash-link" href="#importing-errata" title="Direct link to heading">#</a></h3><p>This time I was able to backup my foreman/katello instance properly, but I was unable to import errata. Every time I did try, I would get the following message:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-text codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Skipping errata [...] â€” No packages found</span></div></div></div></div></div><p>I tried setting <code>--include-repo=</code> after running <code>pulp-admin repo list</code>, but that did not result in any errata info as well. I looked at the GitHub page for the perl script to see if anyone else has ran into a similar issue. Sure enough, an <a href="https://github.com/rdrgmnzs/pulp_centos_errata_import/issues/27" target="_blank" rel="noopener noreferrer">open issue</a> showed up: &quot;All errata fail to import showing no package found&quot;. However it seemed to be a dead end after giving the suggestions a try. Finally I looked at the script itself to see what it was doing, and hopefully where it was failing. I found the spot I was looking for:</p><div class="mdxCodeBlock_1XEh"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_3nn1">Lines 154-156</div><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd undefined">Copy</button><div tabindex="0" class="prism-code language-clike codeBlock_3iAC codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Get all packages </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> current channel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  my @allpkg </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> `pulp</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">admin $pulp_args rpm repo content rpm </span><span class="token operator" style="color:rgb(137, 221, 255)">--</span><span class="token plain">repo</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">id</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">$repo </span><span class="token operator" style="color:rgb(137, 221, 255)">--</span><span class="token plain">fields</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">filename </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> grep Filename</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> awk </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{print \$2}&#x27;</span><span class="token plain"> `</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  chomp @allpkg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div></div></div><p>What this told me is that it was using <code>pulp-admin rpm repo</code> to import/find the relevant information for the errata. I ran <code>pulp-admin rpm repo list</code>, and got zero repos back. There must have been a step I missed or something was amiss in general because I could not find a way for <code>pulp-admin rpm repo</code> to recognize and import my existing yum repo. I tried using an alterative script based in python, <code>katello-centos-errata-import</code>, but I had little luck with that one as well. Once again I felt the need to move on and try at a later time before spinning my wheels for too long.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="restoring-the-foreman-vm"></a>Restoring the Foreman vm<a aria-hidden="true" tabindex="-1" class="hash-link" href="#restoring-the-foreman-vm" title="Direct link to heading">#</a></h3><p>I did make some snapshots of the vm along the way, and decided to rename them since I was starting to not know what the differences were. That seemed like it was a bad idea though - after I set the names of the snapshots to better-suited names than timestamps, I couldn&#x27;t revert the snapshot to right before I tried to import errata. What was strange is command would <em>appear</em> to execute successfully but I knew it wasn&#x27;t, if only because it would be too quick to bring the virsh prompt back. After trying others I realized they all had the same issue: they would appear to execute quickly but the vm was still in the same state before applying. Finally I tried applying an old snapshot that still had the timestamp as its name and the snapshot applied correctly.</p><p>I renamed the snapshot I needed to the timestamp and tried to apply the snapshot again. Sure enough, the timestamp-named snapshot restored the vm. At this point I believe I need to cut my losses entirely on Foreman for now, and proceed with the other steps of the Linux sysadmin guide. The guide is to learn about Linux system administration, not just Foreman administration. I am excited to move on to step 3 in the Linux sysadmin guide, which will have me set up named, dhcpd, and having the dhcp use the Foreman server for pxeboot.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="hows-linux-going"></a>How&#x27;s Linux going?<a aria-hidden="true" tabindex="-1" class="hash-link" href="#hows-linux-going" title="Direct link to heading">#</a></h3><p>Excited to move on from Foreman! I may not be &quot;done&quot; with it but I am happy to be able to focus on something else for a little while.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="sources"></a>Sources<a aria-hidden="true" tabindex="-1" class="hash-link" href="#sources" title="Direct link to heading">#</a></h3><ul><li><a href="https://www.reddit.com/r/OSHA/comments/iiaoyw/this_light_bulb_in_our_walkin_fridge/" target="_blank" rel="noopener noreferrer">Image source</a></li><li><a href="https://github.com/rdrgmnzs/pulp_centos_errata_import/" target="_blank" rel="noopener noreferrer">Perl script to import errata</a></li><li><a href="https://github.com/rdrgmnzs/pulp_centos_errata_import/blob/master/errata_import.pl#L154-L156" target="_blank" rel="noopener noreferrer">Lines 154-156 of perl script</a></li><li><a href="https://github.com/nicolas-r/katello-centos-errata-import" target="_blank" rel="noopener noreferrer">Python script to import errata</a></li></ul></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/website">Website</a><a class="margin-horiz--sm" href="/blog/tags/foreman">Foreman</a><a class="margin-horiz--sm" href="/blog/tags/katello">Katello</a></div></footer></article><div><a href="https://github.com/jeremyhager/yugawa-website/edit/master/blog/2020-09-01-Moving-on-with-forman.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2020/10/07/new-milestone-and-setting-up-networks"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« New milestone and setting up networks</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2020/08/24/Polishing-the-website"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Polishing the website Â»</div></a></div></nav></div></div><div class="col col--2"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#importing-errata" class="table-of-contents__link">Importing errata</a></li><li><a href="#restoring-the-foreman-vm" class="table-of-contents__link">Restoring the Foreman vm</a></li><li><a href="#hows-linux-going" class="table-of-contents__link">How&#39;s Linux going?</a></li><li><a href="#sources" class="table-of-contents__link">Sources</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Internal.Virtnet Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/nixadmin-guide/">Linux Sysadmin Guide</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 Jeremy Hager. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.b2b95ca1.js"></script>
<script src="/runtime~main.699e07b9.js"></script>
<script src="/main.a77cb48e.js"></script>
<script src="/1.2ea10890.js"></script>
<script src="/2.a350c419.js"></script>
<script src="/3.1212bc9f.js"></script>
<script src="/ccc49370.ae4f279a.js"></script>
<script src="/a6df03d7.60b6c868.js"></script>
</body>
</html>